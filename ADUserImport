#Initialises module paramaters and automatically loads when module is called.
#New-ModuleManifest -Path $env:ProgramFiles\WindowsPowerShell\Modules\ADUserImport\ADUserImport.psm1 -RootModule ADUserImport -Author 'Owen Graham' -Description 'PowerShell Project 1 - Import new users to Active Directory using CSV file' -CompanyName 'MSSA-AU SCA1'

<# $Module = New-Module -Name 'ADUserImport' -ScriptBlock {
    Function Import-NewHires {$userInfo = Import-Csv E:\NewHires.csv}
} | Import-Module #>

Function Import-NewHires {
    Param ([string[]]$ImportUserData)
    $Users = Import-Csv -Path E:\NewHires.csv

    foreach ($User in $Users) {
        $Username = "$($User.'Firstname').$($User.'Lastname')"

        $ADUser = Get-ADUser -Filter *


            $userParameters = @{
                $FirstName = $User.FirstName
                $LastName = $User.LastName
                $UPN = $User.UPN
                $Department = $User.Department
                $Address = $User.StreetAddress
                $City = $User.City
                $MobileNum = $User.Mobilephone
                $UserPassword = $User.Password
                $Office = $User.OfficeName
            }
    }

}

function CheckOU {
    param (
        OptionalParameters
    )
}


<# $UserName = 
$FirstName =
$LastName =
$UPN = 
$Department =
$StreetAddress =
$City =
$MobileNum =
$OfficeName =
$Password =

$Domain = ""
$UserOU = "DC=adatum,DC=com," #>

$test = Get-ADUser -Filter * -SearchBase "DC=adatum,dc=com"
$test | set-adus
$test
