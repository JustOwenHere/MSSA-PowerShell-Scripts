#Initialises module paramaters and automatically loads when module is called.
#New-ModuleManifest -Path $env:ProgramFiles\WindowsPowerShell\Modules\ADUserImport\ADUserImport.psm1 -RootModule ADUserImport -Author 'Owen Graham' -Description 'PowerShell Project 1 - Import new users to Active Directory using CSV file' -CompanyName 'MSSA-AU SCA1'

<# $Module = New-Module -Name 'ADUserImport' -ScriptBlock {
    Function Import-NewHires {$userInfo = Import-Csv E:\NewHires.csv}
} | Import-Module #>

[cmdletBinding()]
Param ($CSVPath = 'E:\NewHires.csv')
$Users = Import-Csv -Path $CSVPath



    foreach ($User in $Users) {
        $Username = "$($User.'Firstname').$($User.'Lastname')"

        $ADUser = Get-ADUser -Filter *


            $userParameters = @{
                GivenName = $User.firstName
                Surname = $User.lastName
                UserPrincipalName = $User.upn
                SamAccountName = $SamAccountName
                Department = $User.Department
                StreetAddress = $User.streetaddress
                City = $User.city
                MobilePhone = $User.mobilephone
                AccountPassword = $User.password
                Office = $User.officename
            }
    }
